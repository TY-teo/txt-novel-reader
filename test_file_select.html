<!DOCTYPE html>
<html>
<head>
    <title>测试文件选择功能</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; }
        .test-btn { background: #3498db; color: white; padding: 1rem 2rem; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 1rem 0; }
        .log { background: #f5f5f5; padding: 1rem; border-radius: 5px; margin: 1rem 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>文件选择功能测试</h1>
    
    <h2>测试1：直接HTML onclick</h2>
    <input type="file" id="testFileInput1" accept=".txt" style="display: none;">
    <button class="test-btn" onclick="document.getElementById(\"testFileInput1\").click()">
        HTML onclick方式
    </button>
    
    <h2>测试2：JavaScript addEventListener</h2>
    <input type="file" id="testFileInput2" accept=".txt" style="display: none;">
    <button class="test-btn" id="testBtn2">
        JavaScript addEventListener方式
    </button>
    
    <h2>测试3：原始按钮（复制自小说阅读器）</h2>
    <input type="file" id="fileInput" accept=".txt" style="display: none;">
    <button class="btn btn-primary" onclick="document.getElementById(\"fileInput\").click()">
        选择文件
    </button>
    
    <div class="log" id="log">
        <strong>测试日志：</strong><br>
        准备测试文件选择功能...
    </div>
    
    <script>
        const log = document.getElementById("log");
        
        function addLog(message) {
            log.innerHTML += "<br>" + new Date().toLocaleTimeString() + ": " + message;
        }
        
        // 测试1的事件监听
        document.getElementById("testFileInput1").addEventListener("change", function(e) {
            addLog("测试1 - 文件选择成功：" + (e.target.files[0] ? e.target.files[0].name : "无文件"));
        });
        
        // 测试2的事件绑定
        document.getElementById("testBtn2").addEventListener("click", function() {
            addLog("测试2 - 按钮被点击");
            document.getElementById("testFileInput2").click();
        });
        
        document.getElementById("testFileInput2").addEventListener("change", function(e) {
            addLog("测试2 - 文件选择成功：" + (e.target.files[0] ? e.target.files[0].name : "无文件"));
        });
        
        // 测试3的事件监听
        document.getElementById("fileInput").addEventListener("change", function(e) {
            addLog("测试3 - 原始按钮文件选择成功：" + (e.target.files[0] ? e.target.files[0].name : "无文件"));
        });
        
        addLog("所有测试已准备就绪，请点击按钮测试");
    </script>
</body>
</html>
